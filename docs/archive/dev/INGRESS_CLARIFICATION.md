# Ingress Component Clarification

**Date**: 2025-01-27  
**Status**: üìã Analysis  
**Question**: –ó–∞—á–µ–º –Ω—É–∂–µ–Ω Ingress –∏ –ø–æ—á–µ–º—É –æ–Ω –Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ —Å–ø–∏—Å–æ–∫ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤?

---

## Executive Summary

**Ingress –ù–ï —è–≤–ª—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω—ã–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º —è–¥—Ä–∞ BeamLine Constructor** –∏, –≤–µ—Ä–æ—è—Ç–Ω–æ, —è–≤–ª—è–µ—Ç—Å—è **–∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–º –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ –ø—É—Ç–∞–Ω–∏—Ü–µ–π —Ç–µ—Ä–º–∏–Ω–æ–≤**. –°–æ–≥–ª–∞—Å–Ω–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º—É –∑–∞–¥–∞–Ω–∏—é, —è–¥—Ä–æ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ **5 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤**, –∏ Ingress –≤ —ç—Ç–æ—Ç —Å–ø–∏—Å–æ–∫ –Ω–µ –≤—Ö–æ–¥–∏—Ç.

---

## –ê–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### –Ø–¥—Ä–æ –ø—Ä–æ–¥—É–∫—Ç–∞ (5 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)

–°–æ–≥–ª–∞—Å–Ω–æ `docs/CORE_COMPONENTS.md` –∏ `.trae/state.json`, —è–¥—Ä–æ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑:

1. **C-Gateway** (`apps/c-gateway/`) - HTTP REST API Gateway
2. **Router** (`apps/otp/router/`) - Erlang/OTP orchestrator
3. **Worker CAF** (`apps/caf/processor/`) - C++/CAF compute engine
4. **UI** (`apps/ui_web/`) - SvelteKit/Phoenix LiveView interface
5. **Extensions** - Pluggable NATS services

**Ingress –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —ç—Ç–æ–º —Å–ø–∏—Å–∫–µ.**

### –£–ø–æ–º–∏–Ω–∞–Ω–∏—è Ingress –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

#### 1. CAF Ingress Gateway (CP3 Roadmap)

–í `.windsurf/CAF-IMPLEMENTATION-ROADMAP.md` —É–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è **"CAF Ingress Gateway"**:

```
**1. CAF Ingress Gateway**
- Location: apps/caf/ingress/
- Language: C++ (C++ Actor Framework)
- Tasks:
  - NATS consumer setup (caf.exec.assign.v1)
  - Message parsing and validation
  - ACK publishing (caf.exec.assign.v1.ack)
  - gRPC client for Router communication
```

**–ê–Ω–∞–ª–∏–∑**: –≠—Ç–æ **—á–∞—Å—Ç—å CAF Worker —Å–∏—Å—Ç–µ–º—ã**, –∞ –Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç. –≠—Ç–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å NATS-—Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç Router –∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∏—Ö –≤ CAF Processor.

**–°—Ç–∞—Ç—É—Å**: –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω –¥–ª—è CP3, –Ω–æ **–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω**.

#### 2. Router/Ingress —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ

–í `docs/EXTENSIONS_API.md` (—Å—Ç—Ä–æ–∫–∞ 469):

```
- C-Gateway:
  - converts HTTP requests into NATS requests for **Router/Ingress** using CP1/CP2 contracts;
```

**–ê–Ω–∞–ª–∏–∑**: –í–æ–∑–º–æ–∂–Ω–æ, —ç—Ç–æ **–æ–ø–µ—á–∞—Ç–∫–∞ –∏–ª–∏ —É—Å—Ç–∞—Ä–µ–≤—à–∞—è —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞**. –í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Gateway –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –≤ Router, –∞ –Ω–µ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π Ingress.

#### 3. Kubernetes Ingress

–í `infra/k8s/ingress.yaml` –µ—Å—Ç—å Kubernetes Deployment –¥–ª—è "ingress":

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: ingress
```

**–ê–Ω–∞–ª–∏–∑**: –≠—Ç–æ **–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç** (Kubernetes deployment), –∞ –Ω–µ —á–∞—Å—Ç—å —è–¥—Ä–∞ –ø—Ä–æ–¥—É–∫—Ç–∞. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å:
- –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –±—É–¥—É—â–µ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
- –ü—É—Ç–∞–Ω–∏—Ü–∞ —Å Kubernetes Ingress Controller (–∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º)
- –û—Å—Ç–∞—Ç–æ–∫ –æ—Ç —Å—Ç–∞—Ä–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

#### 4. Observability Requirements

–í `docs/OBSERVABILITY_CP1_INVARIANTS.md` Ingress —É–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ observability:

```
- **Ingress**: Must include `tenant_id`, `trace_id` when available
- **Ingress**: HTTP `GET /_health` (liveness), `GET /_readyz` (readiness)
```

**–ê–Ω–∞–ª–∏–∑**: –≠—Ç–æ **—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –Ω–∞ –±—É–¥—É—â–µ–µ**, –µ—Å–ª–∏ Ingress –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω. –ù–æ —ç—Ç–æ –Ω–µ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ Ingress —è–≤–ª—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω—ã–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º.

---

## –í—ã–≤–æ–¥—ã

### 1. Ingress –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω—ã–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º

**–ü—Ä–∏—á–∏–Ω–∞**: –°–æ–≥–ª–∞—Å–Ω–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º—É –∑–∞–¥–∞–Ω–∏—é (`docs/CORE_COMPONENTS.md`), —è–¥—Ä–æ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 5 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –∏ Ingress –≤ —ç—Ç–æ—Ç —Å–ø–∏—Å–æ–∫ –Ω–µ –≤—Ö–æ–¥–∏—Ç.

### 2. –í–æ–∑–º–æ–∂–Ω—ã–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏

#### –í–∞—Ä–∏–∞–Ω—Ç A: CAF Ingress Gateway (—á–∞—Å—Ç—å Worker)

**–†–æ–ª—å**: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –≤–Ω—É—Ç—Ä–∏ CAF Worker —Å–∏—Å—Ç–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç NATS-—Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç Router.

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**:
```
Router ‚Üí NATS (caf.exec.assign.v1) ‚Üí CAF Ingress Gateway ‚Üí CAF Processor
```

**–°—Ç–∞—Ç—É—Å**: –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω –¥–ª—è CP3, –Ω–æ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ï—Å–ª–∏ —ç—Ç–æ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è, —Ç–æ —ç—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å **—á–∞—Å—Ç—å—é `apps/caf/ingress/`**, –∞ –Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º —è–¥—Ä–∞.

#### –í–∞—Ä–∏–∞–Ω—Ç B: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

**–†–æ–ª—å**: Kubernetes Ingress Controller –∏–ª–∏ –¥—Ä—É–≥–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç.

**–°—Ç–∞—Ç—É—Å**: –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (`infra/docker/ingress/ingress_health.py`) - —ç—Ç–æ stub.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ï—Å–ª–∏ —ç—Ç–æ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, —Ç–æ –æ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ `infra/`, –∞ –Ω–µ –≤ `apps/`, –∏ –Ω–µ –¥–æ–ª–∂–µ–Ω —Å—á–∏—Ç–∞—Ç—å—Å—è —á–∞—Å—Ç—å—é —è–¥—Ä–∞ –ø—Ä–æ–¥—É–∫—Ç–∞.

#### –í–∞—Ä–∏–∞–Ω—Ç C: –£—Å—Ç–∞—Ä–µ–≤—à–∏–π/–æ—Ç–º–µ–Ω–µ–Ω–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

**–†–æ–ª—å**: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–ª—Å—è, –Ω–æ –±—ã–ª –æ—Ç–º–µ–Ω–µ–Ω –∏–ª–∏ –∑–∞–º–µ–Ω–µ–Ω.

**–°—Ç–∞—Ç—É—Å**: –û—Å—Ç–∞—Ç–∫–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –û—á–∏—Å—Ç–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏–π Ingress –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –í–∞—Ä–∏–∞–Ω—Ç 1: –£–¥–∞–ª–∏—Ç—å Ingress –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–î–µ–π—Å—Ç–≤–∏—è**:
1. –£–¥–∞–ª–∏—Ç—å `infra/docker/ingress/` (–∏–ª–∏ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ –∞—Ä—Ö–∏–≤)
2. –£–¥–∞–ª–∏—Ç—å `infra/k8s/ingress.yaml` (–∏–ª–∏ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ Kubernetes Ingress Controller)
3. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:
   - –£–±—Ä–∞—Ç—å —É–ø–æ–º–∏–Ω–∞–Ω–∏—è Ingress –∏–∑ `docs/OBSERVABILITY_CP1_INVARIANTS.md` (–∏–ª–∏ –ø–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ "Future/CP3")
   - –£—Ç–æ—á–Ω–∏—Ç—å —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –≤ `docs/EXTENSIONS_API.md`
4. –û–±–Ω–æ–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã:
   - –£–±—Ä–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ Ingress –∏–∑ `validate_observability_e2e.sh` (–∏–ª–∏ –ø–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ optional)

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ**: 
- Ingress –Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ —è–¥—Ä–æ –ø—Ä–æ–¥—É–∫—Ç–∞
- –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è - stub
- –ù–µ—Ç —á–µ—Ç–∫–æ–≥–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –Ω–∞ Ingress –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

### –í–∞—Ä–∏–∞–Ω—Ç 2: –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å Ingress –∫–∞–∫ —á–∞—Å—Ç—å CAF Worker

**–î–µ–π—Å—Ç–≤–∏—è**:
1. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å/–ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å:
   - `infra/docker/ingress/` ‚Üí `apps/caf/ingress/`
   - –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é: "CAF Ingress Gateway" –∫–∞–∫ —á–∞—Å—Ç—å Worker —Å–∏—Å—Ç–µ–º—ã
2. –û–±–Ω–æ–≤–∏—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:
   - –£—Ç–æ—á–Ω–∏—Ç—å, —á—Ç–æ Ingress - —ç—Ç–æ –ø–æ–¥–∫–æ–º–ø–æ–Ω–µ–Ω—Ç Worker, –∞ –Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —è–¥—Ä–∞
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–æ–≥–ª–∞—Å–Ω–æ CP3 roadmap:
   - NATS consumer –¥–ª—è `caf.exec.assign.v1`
   - gRPC client –¥–ª—è Router
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CAF Processor

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ**:
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç CP3 roadmap
- –õ–æ–≥–∏—á–Ω–æ –∫–∞–∫ —á–∞—Å—Ç—å CAF Worker —Å–∏—Å—Ç–µ–º—ã
- –ù–µ –Ω–∞—Ä—É—à–∞–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø "5 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —è–¥—Ä–∞"

### –í–∞—Ä–∏–∞–Ω—Ç 3: –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å Ingress –∫–∞–∫ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

**–î–µ–π—Å—Ç–≤–∏—è**:
1. –û—Å—Ç–∞–≤–∏—Ç—å –≤ `infra/`:
   - `infra/docker/ingress/` - –∫–∞–∫ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
   - `infra/k8s/ingress.yaml` - –∫–∞–∫ Kubernetes deployment
2. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:
   - –ü–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ "Infrastructure Component", –Ω–µ "Core Component"
   - –£—Ç–æ—á–Ω–∏—Ç—å —Ä–æ–ª—å: Kubernetes Ingress Controller –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
   - Health endpoints –¥–ª—è Kubernetes probes
   - –ë–∞–∑–æ–≤–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ**:
- –ù–µ –Ω–∞—Ä—É—à–∞–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø "5 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —è–¥—Ä–∞"
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–µ–Ω –¥–ª—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —è–¥—Ä–∞

---

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

**–§–∞–π–ª—ã**:
- `infra/docker/ingress/ingress_health.py` - stub health check
- `infra/k8s/ingress.yaml` - Kubernetes deployment

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è (—Ç–æ–ª—å–∫–æ health check stub)

**–°—Ç–∞—Ç—É—Å**: –ù–µ production-ready, –Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ —è–¥—Ä–æ –ø—Ä–æ–¥—É–∫—Ç–∞

### Observability

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**: –£–ø–æ–º–∏–Ω–∞—é—Ç—Å—è –≤ `docs/OBSERVABILITY_CP1_INVARIANTS.md`, –Ω–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω.

**CP1 Fields**:
- `tenant_id` - Required when tenant context available
- `trace_id` - Required when trace context available
- `run_id`, `flow_id`, `step_id` - Not required (Ingress does not process runs/flows/steps)

**Health Endpoints**:
- `GET /_health` - Liveness probe
- `GET /_readyz` - Readiness probe

---

## –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –£–¥–∞–ª–∏—Ç—å Ingress –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

**–ü—Ä–∏—á–∏–Ω—ã**:
1. Ingress –Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ —Å–ø–∏—Å–æ–∫ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
2. –ù–µ—Ç —á–µ—Ç–∫–æ–≥–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –Ω–∞ Ingress –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
3. –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è - stub –±–µ–∑ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
4. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ Ingress (Gateway ‚Üí Router ‚Üí Worker)

**–î–µ–π—Å—Ç–≤–∏—è**:
1. –£–¥–∞–ª–∏—Ç—å –∏–ª–∏ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å `infra/docker/ingress/`
2. –£–¥–∞–ª–∏—Ç—å –∏–ª–∏ –∑–∞–º–µ–Ω–∏—Ç—å `infra/k8s/ingress.yaml`
3. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:
   - –£–±—Ä–∞—Ç—å Ingress –∏–∑ —Å–ø–∏—Å–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ observability –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
   - –ü–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ "Future/CP3" –∏–ª–∏ "Deprecated"
4. –û–±–Ω–æ–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã:
   - –°–¥–µ–ª–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ Ingress optional –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å

**–ï—Å–ª–∏ –Ω—É–∂–µ–Ω CAF Ingress Gateway**:
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–∞–∫ —á–∞—Å—Ç—å `apps/caf/ingress/` —Å–æ–≥–ª–∞—Å–Ω–æ CP3 roadmap
- –ù–µ —Å—á–∏—Ç–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º —è–¥—Ä–∞

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü—Ä–∏–Ω—è—Ç—å —Ä–µ—à–µ–Ω–∏–µ**: –ö–∞–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –≤—ã–±—Ä–∞—Ç—å (1, 2, –∏–ª–∏ 3)?
2. **–û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é**: –£—Ç–æ—á–Ω–∏—Ç—å —Ä–æ–ª—å Ingress (–∏–ª–∏ —É–¥–∞–ª–∏—Ç—å —É–ø–æ–º–∏–Ω–∞–Ω–∏—è)
3. **–û—á–∏—Å—Ç–∏—Ç—å –∫–æ–¥**: –£–¥–∞–ª–∏—Ç—å stub –∏–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–æ–≥–ª–∞—Å–Ω–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –≤–∞—Ä–∏–∞–Ω—Ç—É
4. **–û–±–Ω–æ–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é**: –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –ø–æ–¥ –≤—ã–±—Ä–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

---

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- `docs/CORE_COMPONENTS.md` - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–¥—Ä–∞ –ø—Ä–æ–¥—É–∫—Ç–∞ (5 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)
- `.windsurf/CAF-IMPLEMENTATION-ROADMAP.md` - CP3 roadmap (CAF Ingress Gateway)
- `docs/OBSERVABILITY_CP1_INVARIANTS.md` - Observability requirements
- `docs/EXTENSIONS_API.md` - Gateway/Router/Ingress —É–ø–æ–º–∏–Ω–∞–Ω–∏—è
- `infra/k8s/ingress.yaml` - Kubernetes deployment
- `infra/docker/ingress/ingress_health.py` - Stub implementation

---

## –í—ã–≤–æ–¥

**Ingress –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω—ã–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º —è–¥—Ä–∞ BeamLine Constructor** –∏, –≤–µ—Ä–æ—è—Ç–Ω–æ, —è–≤–ª—è–µ—Ç—Å—è:
- –ê—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–º –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (CAF Ingress Gateway –∫–∞–∫ —á–∞—Å—Ç—å Worker)
- –ü—É—Ç–∞–Ω–∏—Ü–µ–π —Ç–µ—Ä–º–∏–Ω–æ–≤ (Kubernetes Ingress vs –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–æ–¥—É–∫—Ç–∞)
- –£—Å—Ç–∞—Ä–µ–≤—à–∏–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º (–æ—Ç–º–µ–Ω–µ–Ω –∏–ª–∏ –∑–∞–º–µ–Ω–µ–Ω)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –£–¥–∞–ª–∏—Ç—å Ingress –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–ª–∏ —á–µ—Ç–∫–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –µ–≥–æ —Ä–æ–ª—å (—á–∞—Å—Ç—å Worker –∏–ª–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç).

